!function(a){var b,c;!function(){var a={},d={};b=function(b,c,d){a[b]={deps:c,callback:d}};var e=/^\.\//;c=function(b){if(b=e.test(b)?b.replace(e,""):b,d[b])return d[b];d[b]={};var f=a[b];if(!f)throw new Error("Module '"+b+"' not found.");for(var g,h=f.deps,i=f.callback,j=[],k=0,l=h.length;l>k;k++)"exports"===h[k]?j.push(g={}):j.push(c(h[k]));var m=i.apply(this,j);return d[b]=g||m}}(),b("superapi/agent",["exports"],function(a){"use strict";function b(a){if(!a)throw new Error("missing superagent or any api compatible agent.");this.agent=a}b.prototype={buildRequest:function(a,b,c,d){if(a=a.toLowerCase(),d=d||{},!this.agent)throw new Error("missing superagent or any api compatible agent.");"delete"===a&&(a="del"),"del"===a&&(c=void 0);var e=this.agent[a];if(!e)throw new Error("Unsupported method ["+a+"]");var f=e(b,c);this._setHeaders(f,this.config.headers),this._setOptions(f,this.config.options),this._setOptions(f,d.options),this._setHeaders(f,d.headers),this._setHeaders(f,this.headers),this.config.withCredentials&&f.withCredentials();var g=this.config.auth;return g&&this._setAuth(f,g),f},addHeader:function(a,b){this.headers=this.headers||{},this.headers[a]=b},removeHeader:function(a){this.headers&&this.headers[a]&&delete this.headers[a]},_setHeaders:function(a,b){for(var c in b)a.set(c,b[c])},_setOptions:function(a,b){for(var c in b)a[c](b[c])},_setAuth:function(a,b){b&&_req.auth(b.user||"",b.pass||"")},handleResponse:function(a,b){return new Promise(function(c,d){return b?c(b):(a.on("error",d),a.on("abort",function(){var a=new Error("Request has been aborted");a.aborted=!0,d(a)}),void a.end(function(a,b){var e=a||b.error;return e?d(e):void c(b)}))})}},a["default"]=b}),b("superapi/api",["exports"],function(a){"use strict";function b(a){this.api=Object.create(null),this.configure(a)}b.prototype={paramsPattern:/:(\w+)/g,configure:function(a){if(this.config=a||{},a){this._agent&&(this._agent.config=a);for(var c in a.services)Object.prototype.hasOwnProperty(this,c)||(this.api[c]=b.defaults.serviceHandler(c).bind(this))}},agent:function(){if(!this._agent)throw new Error("no agent configured");return this._agent},withAgent:function(a){if(!a)throw new Error("missing agent");return this._agent=new b.defaults.agent(a),this.config&&(this._agent.config=this.config),this},service:function(a){return this.config.services?this.config.services[a]:null},url:function(a){var b=this.config.baseUrl,c=this.service(a)||a;if(c){var d;if("string"==typeof c&&(d=c),"object"==typeof c&&void 0!==c.path&&(d=c.path),!d)throw new Error("path is not defined for route $"+a);d.match(/^https?:\/\//)?b=d:b+="/"===d[0]?d:"/"+d}return b},replaceUrl:function(a,b){var c=a.match(this.paramsPattern);if(!c||!c.length)return a;for(var d=0,e=c.length;e>d;d+=1){var f=c[d],g=f.substring(1);b[g]&&(a=a.replace(f,b[g]))}return a},buildUrlQuery:function(a){if(!a)return"";var b;if("string"==typeof a)b=a;else{var c=[];for(var d in a)c.push(d+"="+a[d]);b=c.join("&")}return b?"?"+b:""},buildUrl:function(a,b,c){var d=this.url(a);return b&&(d=this.replaceUrl(d,b)),c&&(d+=this.buildUrlQuery(c)),d},request:function(a,b,c,d,e){var f=this.service(a);e=e||(f&&f.method?f.method:"get");var g=f?{options:f.options,headers:f.headers}:{};return this.agent().buildRequest(e,this.buildUrl(a,c,d),b,g)},get:function(a,b,c){return this._http("get",a,b,c)},post:function(a,b,c){return this._http("post",a,b,c)},put:function(a,b,c){return this._http("put",a,b,c)},del:function(a,b,c){return this._http("del",a,b,c)},patch:function(a,b,c){return this._http("patch",a,b,c)},head:function(a,b,c){return this._http("head",a,b,c)},_http:function(a,c,d,e){return d=d||{},d.data=e,d.method=a,b.defaults.serviceHandler(c).call(this,d)},addHeader:function(a,b){this.agent().addHeader(a,b)},removeHeader:function(a){this.agent().removeHeader(a)},middleware:function(a){if(!this.middlewares)return null;var b=this.middlewares.filter(function(b){return b.name===a});return b.length>0?b[0]:null},status:function(a,c){this.middleware("status")||this.register("status",b.defaults.middlewares.status());var d=this.middleware("status");return d.fn.set(a,c),d},register:function(a,b){this.middlewares||(this.middlewares=[]),this.middlewares.push({name:a,fn:b})},_serviceMiddlewares:function(a,b){return this.middlewares?this.middlewares.filter(function(a){return b&&b.use?b.use&&b.use[a.name]!==!1:!0}):[]},_applyMiddlewares:function(a,b,c){var d=this.service(b),e=this._serviceMiddlewares(a,d),f=this.agent(),g=function(b,d){return new Promise(function(d,g){c.push([d,g]),b===e.length-1&&d(f.handleResponse(a))})},h=Promise.resolve();return e.forEach(function(b,c){var e=b.fn(a,g.bind(this,c),d);e&&(h=h.then("function"==typeof e?e:function(){return e}))},this),h}},a["default"]=b}),b("superapi/middlewares/status",["exports"],function(a){"use strict";a["default"]=function(){var a={},b=function(b,c){c().then(function(c){if(c){var d=a[c.status];if(d)return d(b,c)}})["catch"](function(c){var d=a[c.status||c.reason];if(d)return d(b,c.response?c.response:c)})};return b.set=function(b,c){a[b]=c},b.get=function(b){return a[b]},b}}),b("superapi/middlewares/trace",["exports"],function(a){"use strict";a["default"]=function(a){a=a||{};var b=a.log||null,c=window.performance||{now:Date.now};return function(a,d){if(b){var e=c.now();d().then(function(a){b(c.now()-e)})["catch"](function(a){b(c.now()-e)})}}}}),b("superapi/service-handler",["exports"],function(a){"use strict";a["default"]=function(a){return function(b){return new Promise(function(c,d){b=b||{};var e=b.data||{},f=b.params||{},g=b.query||{},h=b.callback||null,i=b.edit||null,j=this.request(a,e,f,g,b.method);i&&"function"==typeof i&&i(j);var k=function(a,b){return function(c,d){b&&b.reverse().forEach(function(a){c&&a[1](c),a[0](d)}),a(c,d),h&&h(c,d)}},l=[],m=k(function(a,b){d(a)},l),n=k(function(a,b){c(b)},l),o=this.agent();return this._applyMiddlewares(j,a,l).then(function(a){return o.handleResponse(j,a)}).then(function(a){return n(null,a)})["catch"](function(a){return m(a)})}.bind(this))}}}),b("superapi",["./superapi/api","./superapi/agent","./superapi/service-handler","./superapi/middlewares/status","exports"],function(a,b,c,d,e){"use strict";function f(a){return new g(a)}var g=a["default"],h=b["default"],i=c["default"],j=d["default"];g.defaults={agent:h,serviceHandler:i,middlewares:{status:j}},f.prototype.Api=g,e["default"]=f}),window.superapi=c("superapi")}(window);